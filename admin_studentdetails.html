<!DOCTYPE html>

<html>
    <head>
        <title>Outdoor Equity Alliance: Admin Interface</title>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

        <style>
            .hiddenRow {
                padding: 0 !important;
            }
        </style>
    </head>

    <body>

        <h2>Welcome {{username}}</h2>

        <hr>

        <h1>Student Information</h1>
        <h2>Student ID: {{studentid}}</h2>

        <h3>Enrolled Programs</h3>
        {% if student_info['Enrolled Programs']|length != 0: %}


        <table class = "table">
            <thead>
                <tr>
                    <th align = "left">Program ID</th>
                    <th align = "left">Program Name</th>
                    <th align = "left">Student Progress</th>
                </tr>
            </thead>
            <tbody>
                {% for pgm in student_info['Enrolled Programs']: %}
                <tr data-toggle="collapse" data-target="#view_{{pgm['program_id']}}">
                    <td align= 'left'>
                        {{pgm['program_id']}}
                    </td>
                    <td>
                        {{pgm['program_name']}}
                    </td>
                    <td>
                        {{pgm['pgm_progress']}}
                    </td>
                    <td>
                        <button type = "button" class="btn btn-info btn-sm">
                            <span class="glyphicon glyphicon-info-sign"></span> View Assessments
                        </button>
                    </td>
                </tr>
                <tr>
                    <td colspan="12" class="hiddenRow">
                        <div class="collapse" id="view_{{pgm['program_id']}}">
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    {% include 'admin_studentdetails_assessments.html' %}

                                </div>
                            </div>
                        </div>

                    </td>

                </tr>

                {% endfor %}

            </tbody>

        </table>



        {% else %}
            Student not enrolled in any programs yet.
        {% endif %}

        <h3>Available Programs</h3>
        {% if student_info['Available Programs']|length != 0: %}

        <table class = "table">
            <thead>
                <tr>
                    <th align = "left">Program ID</th>
                    <th align = "left">Program Name</th>
                </tr>
            </thead>
            <tbody>
                {% for pgm in student_info['Available Programs']: %}
                    <tr>
                        <td>
                            {{pgm['program_id']}}
                        </td>
                        <td>
                            {{pgm['program_name']}}
                        </td>
                        <td>
                            <button type = "button" class="btn btn-basic btn-sm" data-toggle="collapse" data-target="#edit_{{pgm['program_id']}}Status"> <span class="glyphicon glyphicon-edit"></span> Edit Program Status</button>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="12" class="hiddenRow">
                            <div class="collapse" id="edit_{{pgm['program_id']}}Status">
                                <div class="panel panel-default">
                                    <form id = "update_{{pgm['program_id']}}Status" action="{{'/admin/students/studentdetails?updateStatus=true&category=pgm&studentid=%s&id=%s' %(studentid, pgm['program_id'])}}" method='POST' >
                                        <p>Please select program status for the student:</p>
                                        <input type="radio" id = "{{pgm['program_id']}}_available" name="pgm_progress" value="available" checked>
                                        <label for="{{pgm['program_id']}}_available">Make available (unlock)</label><br>

                                        <input type="radio" id="{{pgm['program_id']}}_locked" name="pgm_progress" value="locked">
                                        <label for="{{pgm['program_id']}}_locked">Lock program</label><br>

                                        <input type="radio" id="{{pgm['program_id']}}_enrolled" name="pgm_progress" value="enrolled">
                                        <label for="{{pgm['program_id']}}_enrolled">Enroll student</label> <br>

                                        <button type="submit" form="update_{{pgm['program_id']}}Status" value="Submit">Submit</button>
                                    </form>

                                </div>
                            </div>

                        </td>

                    </tr>

                {% endfor %}


            </tbody>


        </table>


        {% else %}
            No available programs yet.
        {% endif %}

    <!-- to unlock program for studentid -->
    <h3>Locked Programs</h3>
    {% if student_info['Available Programs']|length != 0: %}
    <table class = "table">

        <thead>
            <tr>
                <th align = "left">Program ID</th>
                <th align = "left">Program Name</th>
            </tr>
        </thead>
        <tbody>
            {% for pgm in student_info['Locked Programs']: %}
            <tr>
                <td>
                    {{pgm['program_id']}}
                </td>
                <td>
                    {{pgm['program_name']}}
                </td>
                <td>
                    <button type = "button" class="btn btn-basic btn-sm" data-toggle="collapse" data-target="#edit_{{pgm['program_id']}}Status"><span class="glyphicon glyphicon-edit"></span>Edit Program Status</button>

                </td>
            </tr>
            <tr>
                <td colspan="12" class="hiddenRow">
                    <div class="collapse" id="edit_{{pgm['program_id']}}Status">
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <form id = "update_{{pgm['program_id']}}Status" action="{{'/admin/students/studentdetails?updateStatus=true&category=pgm&studentid=%s&id=%s' %(studentid, pgm['program_id'])}}" method='POST'>
                                    <p>Please select program status for the student:</p>
                                    <input type="radio" id = "{{pgm['program_id']}}_available" name="pgm_progress" value="available">
                                    <label for="{{pgm['program_id']}}_available">Make available (unlock)</label><br>

                                    <input type="radio" id="{{pgm['program_id']}}_locked" name="pgm_progress" value="locked" checked>
                                    <label for="{{pgm['program_id']}}_locked">Lock program</label><br>

                                    <input type="radio" id="{{pgm['program_id']}}_enrolled" name="pgm_progress" value="enrolled">
                                    <label for="{{pgm['program_id']}}_enrolled">Enroll student</label> <br>

                                    <button type="submit" form="update_{{pgm['program_id']}}Status" value="Submit">Submit</button>
                                </form>
                            </div>
                        </div>
                    </div>

                </td>

            </tr>


            {% endfor %}

        </tbody>


    </table>

    {% else %}
        No locked programs yet.
    {% endif %}



    <a href="/admin/students">Back to users</a>





    <script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script>
        'use strict';


        let request = null;


        function editModuleStatus(module){
            let element_id = "#update_" + module + "Status";

            $(element_id).show();
        }

        function editProgramStatus(pgm){
            let element_id = "#update_" + pgm + "Status";

            $(element_id).show();
        }



    </script>

    </body>
</html>